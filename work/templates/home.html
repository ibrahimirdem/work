{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container mt-3">

<div class="row overflow-auto">
  <div class="card w-50">
    <div class="card-header">
      Notlar
    </div>
    <div class="card-body overflow-auto pt-1 pl-0" style="height:200px;">
      <ul class="list-group list-group-flush">
      {% for notum in notlar %}

        <li class="list-group-item pt-1 pb-0 pl-3"><input type="checkbox"  id="{{notum.id}}" name="{{notum.id}}" onclick="myFunction(this.name)" {% if notum.yapildi_mi %} checked{% endif %}>
        <label id="label-{{notum.id}}" name="{{notum.id}}" style="text-decoration:{% if notum.yapildi_mi %}line-through{% else %}none{% endif %}; color:{% if notum.yapildi_mi %}gray{% else %}black{% endif %};">{{notum.not_aciklama}}</label></li>

      {% endfor %}
      </ul>
    </div>
    <div class="card-footer ">
      <form method="POST" class="form-inline m-0" >{% csrf_token %}
        {{forms|crispy}}
        <button class="btn btn-primary ml-2" type="submit">Ekle</button>
      </form>
    </div>
  </div>
</div>
<br>

</div>
<script>

function myFunction(isim) {
  var checkBox = document.getElementById(isim);
  var text = document.getElementById("label-"+isim);

  if (checkBox.checked == true){
    text.style.textDecoration = "line-through";
    text.style.color = "gray";
    $.ajax({
        url: '/ajax/validate_username/',
        data: {'numara': isim, 'deger':'yapildi'},
        dataType: 'json',
        success: function (data) {
          if (data.is_taken) {
            console.log('Başarılıl');
          }
        }
      });

  } else {
     text.style.textDecoration = "none";
     text.style.color = "black";
     $.ajax({
        url: '/ajax/validate_username/',
        data: {'numara': isim, 'deger':'yapilmadi'},
        dataType: 'json',
        success: function (data) {
          if (data.is_taken) {
            console.log('Başarılıl');
          }
        }
      });
  }
}
</script>
{% endblock content %}